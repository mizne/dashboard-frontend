<div class="cex-future-page-container">
  <div nz-row [nzGutter]="16">
    <div nz-col class="gutter-row" [nzSpan]="18">
      <nz-card>
        <cex-future-longshort-chart></cex-future-longshort-chart>
        <cex-future-fundingrate-chart></cex-future-fundingrate-chart>
      </nz-card>

      <nz-card style="margin-top: 12px">
        <form nz-form [formGroup]="form" (ngSubmit)="submitForm()" [nzLayout]="'inline'">
          <nz-form-item>
            <nz-form-label nzFor="symbol">symbol</nz-form-label>
            <nz-form-control>
              <input nz-input class="ant-input" placeholder="请输入symbol" formControlName="symbol" [attr.id]="'symbol'" />
            </nz-form-control>
          </nz-form-item>

          <nz-form-item class="register-area">
            <nz-form-control>
              <button nz-button [nzType]="'primary'">搜索</button>
              <button nz-button type="button" (click)="resetForm()" style="margin-left: 12px">重置</button>
            </nz-form-control>
          </nz-form-item>
        </form>
      </nz-card>

      <nz-card style="margin-top: 12px">
        <nz-table nzShowSizeChanger [nzData]="items" [nzFrontPagination]="false" [nzLoading]="loading" [nzTotal]="total"
          [nzShowTotal]="rangeTemplate" [nzPageSize]="pageSize" [nzPageIndex]="pageIndex"
          (nzQueryParams)="onQueryParamsChange($event)">
          <thead>
            <tr>
              <th nzColumnKey="symbol">symbol</th>
              <th nzColumnKey="baseAsset">跟踪标的</th>
              <th nzColumnKey="contractType">合约类型</th>
              <th nzColumnKey="createdAtStr" [nzSortFn]="true">添加时间</th>
              <th nzColumnKey="Action" style="width: 130px;">操作</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let data of items">
              <td style="display: flex; align-items: center; min-height: 70px;">
                <image-view [name]="data.logoName"></image-view>
                <span style="margin-left: 8px">{{ data.symbol }}</span>
              </td>
              <td>
                <span>{{ data.baseAsset }}</span>
              </td>
              <td>
                <span>{{ data.contractType }}</span>
              </td>

              <td>
                <created-at [createdAt]="data.createdAt"></created-at>
              </td>
              <td>
                <button nz-button (click)="confirmView(data)" nzType="primary" nzShape="circle" nzSize="small"
                  nz-tooltip [nzTooltipTitle]="'查看'" style="margin-right: 4px">
                  <i nz-icon nzType="eye" nzTheme="outline"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </nz-table>

        <ng-template #rangeTemplate let-range="range" let-total>
          {{ range[0] }}-{{ range[1] }} of {{ total }} items
        </ng-template>
      </nz-card>
    </div>
    <div nz-col class="gutter-row" [nzSpan]="6">
      <notify-history-list [condition]="{type: marketType}"></notify-history-list>
    </div>
  </div>

  <nz-modal [(nzVisible)]="futureDetailModalVisible" [nzTitle]="futureDetailModalTitle" [nzWidth]="1000"
    (nzOnCancel)="futureDetailModalVisible=false" (nzOnOk)="futureDetailModalVisible=false">
    <ng-container *nzModalContent>
      <nz-card>
        <div nz-row [nzGutter]="16">
          <div nz-col class="gutter-row" [nzSpan]="24">
            <div class="inner-box">
              <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 18px;">
                开仓量
              </div>
              <tradingview-chart [series]="openInterestSeries" [width]="900"
                [options]="chartOptions"></tradingview-chart>
            </div>
          </div>
          <div nz-col class="gutter-row" [nzSpan]="24">
            <div class="inner-box">
              <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 18px;">
                资金费率
              </div>
              <tradingview-chart [series]="fundingRateSeries" [width]="900"
                [options]="chartOptions"></tradingview-chart>
            </div>
          </div>
          <div nz-col class="gutter-row" [nzSpan]="24">
            <div class="inner-box">
              <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 18px;">
                多空比
              </div>
              <tradingview-chart [series]="longShortRatioSeries" [width]="900"
                [options]="chartOptions"></tradingview-chart>
            </div>
          </div>
        </div>
      </nz-card>
    </ng-container>
  </nz-modal>
</div>